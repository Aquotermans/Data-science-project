##
SELECT top(1000)	c.*, cd.diagnostic_icd10, cd.contact_diagnostic_label
  FROM [cegedim].[dbo].[contact] as c

  JOIN [cegedim].[dbo].[CONTACT_DIAGNOSTICS] as cd on c.contact_id = cd.contact_id 

	and cd.diagnostic_icd10 not like 'C34%' 
	and cd.diagnostic_icd10 not like 'i%'

  where c.person_age > 45;


##
SELECT top(100) pbc.person_id, pbc.contact_id, pbc.person_age, pbc.start_change_date, pbc.end_change_date, pbc.value,
ce.code AS codelist_label,
mm.concept_name
FROM [cegedim].[dbo].PERSON_BIOLOGIC_CHANGES AS pbc
LEFT JOIN [cegedim].[dbo].CODELIST_EXTRACT AS ce ON pbc.biologic_exam_label = ce.label
LEFT JOIN [cegedim].[dbo].mapping_measurement AS mm ON ce.code = mm.measurement_source_value

where  pbc.end_change_date like '999%' order by person_id asc;
